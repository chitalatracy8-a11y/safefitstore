
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Admin Dashboard | Safe Fit Store</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
  * { margin:0; padding:0; box-sizing:border-box; font-family: Arial, sans-serif; }
  body { background: #f0f4f8; min-height:100vh; display:flex; flex-direction:column; }

  header {
    background-color: #2c3e50;
    color: white;
    padding: 1rem 2rem;
    text-align: center;
    box-shadow: 0 2px 5px rgba(0,0,0,0.4);
  }

  .container { display:flex; flex-grow:1; }

  .sidebar {
    width: 240px;
    background-color: #34495e;
    padding-top:1rem;
    flex-shrink:0;
    display:flex;
    flex-direction:column;
    height:100vh;
    position:fixed;
    top:0; left:0;
    transition:0.3s;
    overflow-y:auto;
  }
  .sidebar a {
    display:flex; align-items:center; gap:10px;
    padding:1rem; color:white; text-decoration:none;
    transition: background 0.3s, padding-left 0.3s;
  }
  .sidebar a:hover { background-color:#1abc9c; padding-left:30px; }
  .sidebar a.active { background-color:#16a085; }
  .sidebar a.logout { margin-top:auto; background:#e74c3c; }
  .sidebar a.logout:hover { background:#c0392b; padding-left:30px; }

  .main-content {
    margin-left:240px;
    padding:2rem;
    flex:1;
    min-height:100vh;
  }

  h2 { color:#2c3e50; margin-bottom:1rem; }

  .cards {
    display:grid;
    grid-template-columns:repeat(auto-fit, minmax(220px, 1fr));
    gap:1.5rem;
    margin-top:2rem;
  }
  .card {
    background:white;
    border-radius:12px;
    padding:1.5rem;
    text-align:center;
    box-shadow:0 4px 8px rgba(0,0,0,0.1);
    transition:transform 0.3s;
    cursor:pointer;
  }
  .card:hover { transform:translateY(-5px); }
  .card i { font-size:2rem; color:#1abc9c; margin-bottom:0.5rem; }

  @media(max-width:768px){
    .container{flex-direction:column;}
    .sidebar{position:relative;width:100%;height:auto;padding-top:0;}
    .main-content{margin-left:0;}
    .cards{grid-template-columns:1fr;}
  }
</style>
</head>
<body>

<header>
  <h1 id="welcome-admin">Admin Dashboard</h1>
</header>

<div class="container">
  <nav class="sidebar">
    <a href="manage_users.html" class="active"><i class="fa fa-users"></i> Manage Users</a>
    <a href="manage_products.html"><i class="fa fa-box"></i> Manage Products</a>
    <a href="manage_orders.html"><i class="fa fa-shopping-cart"></i> Manage Orders</a>
    <a href="contact_requests.html"><i class="fa fa-envelope"></i> Messages</a>
    <a href="discounts.html"><i class="fa fa-percent"></i> Promotions</a>
    <a href="#" class="logout" id="logoutBtn"><i class="fa fa-sign-out-alt"></i> Logout</a>
  </nav>

  <main class="main-content">
    <h2>Welcome, Admin!</h2>
    <p>Select an option from the sidebar or use the quick-access cards below.</p>

    <div class="cards">
      <div class="card" onclick="location.href='manage_users.html'">
        <i class="fa fa-users"></i>
        <h3>Users</h3>
        <p>Manage and monitor user accounts.</p>
      </div>
      <div class="card" onclick="location.href='manage_products.html'">
        <i class="fa fa-box"></i>
        <h3>Products</h3>
        <p>View, add, and update product details.</p>
      </div>
      <div class="card" onclick="location.href='manage_orders.html'">
        <i class="fa fa-shopping-cart"></i>
        <h3>Orders</h3>
        <p>Track and process customer orders.</p>
      </div>
      <div class="card" onclick="location.href='contact_requests.html'">
        <i class="fa fa-envelope"></i>
        <h3>Messages</h3>
        <p>Respond to customer enquiries.</p>
      </div>
    </div>
  </main>
</div>

<script>
  // Role and token check
  const token = localStorage.getItem("token");
  const role = localStorage.getItem("role");

  if(!token || role !== "admin"){
    alert("Access denied! Redirecting to login.");
    window.location.href = "login.html";
  } else {
    // Fetch admin username from backend
    fetch("http://localhost:5000/api/admin_dashboard", {
      headers: { "Authorization": `Bearer ${token}` }
    })
    .then(res => res.json())
    .then(data => {
      if(data.username){
        document.getElementById("welcome-admin").textContent = "Welcome, " + data.username + "!";
      } else {
        localStorage.removeItem("token");
        localStorage.removeItem("role");
        window.location.href = "login.html";
      }
    })
    .catch(err => console.error("Error fetching admin data:", err));
  }

  // Logout
  document.getElementById("logoutBtn").addEventListener("click", e => {
    e.preventDefault();
    localStorage.removeItem("token");
    localStorage.removeItem("role");
    window.location.href = "login.html";
  });
</script>

</body>
</html>
