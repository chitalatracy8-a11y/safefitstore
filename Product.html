 <!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SafeFit Store - Products</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
  body {
    margin:0;
    font-family: Arial, sans-serif;
    background: url('images/BACKGROUNDSTT.jpg') no-repeat center/cover;
    background-size: cover;
  }

  nav {
    background-color: rgba(0,0,0,0.7);
    padding: 15px;
    text-align: center;
  }
  nav a {
    color:white; margin:0 15px; text-decoration:none; font-weight:bold; font-size:16px;
  }
  nav a:hover { text-decoration: underline; }

  h1 {
    text-align: center;
    color: white;
    padding: 30px 0 10px;
    font-size: 40px;
    text-shadow: 2px 2px 5px #000;
  }

  .products-container {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 25px;
    padding: 30px;
    max-width: 1200px;
    margin: 0 auto;
  }

  .product-box {
    background-color: rgba(255, 255, 255, 0.15);
    backdrop-filter: blur(10px);
    border-radius: 15px;
    overflow: hidden;
    color: white;
    transition: transform 0.3s, background-color 0.3s;
    display: flex;
    flex-direction: column;
    text-align: center;
    padding-bottom: 15px;
    cursor: pointer;
  }
  .product-box:hover {
    background-color: #ffffff;
    transform: scale(1.05);
    color: black;
  }
  .product-box img {
    width:100%;
    height:200px;
    object-fit: cover;
  }
  .product-box h3 {
    margin: 10px 0 5px;
  }
  .product-box p {
    margin: 0;
    font-weight: bold;
    font-size: 18px;
  }

  .product-actions {
    margin-top: 10px;
  }
  .product-actions button {
    margin: 5px;
    padding: 8px 15px;
    border:none;
    border-radius:5px;
    cursor:pointer;
    font-weight:bold;
    transition: 0.3s;
  }
  .add-cart { background:#008cba; color:white; }
  .add-cart:hover { background:#005f80; }
  .edit-product { background:#1abc9c; color:white; }
  .edit-product:hover { background:#16a085; }

  @media (max-width: 600px) {
    nav a { display:block; margin:10px 0; }
  }
</style>
</head>
<body>

<nav>
  <a href="index.html">Home</a>
  <a href="product.html">Products</a>
  <a href="about.html">About</a>
  <a href="contact.html">Contact</a>
  <a href="login.html">Login</a>
</nav>

<h1>Our Products</h1>

<div class="products-container" id="products-list">
  <!-- Products will load dynamically -->
</div>

<script>
const token = localStorage.getItem('token');
const role = localStorage.getItem('role'); // admin or user

fetch('http://localhost:5000/api/products', {
  headers: token ? { 'Authorization': 'Bearer ' + token } : {}
})
.then(res => res.json())
.then(data => {
  const container = document.getElementById('products-list');
  container.innerHTML = '';

  if(data.length > 0){
    data.forEach(product => {
      const div = document.createElement('div');
      div.className = 'product-box';

      div.innerHTML = `
        <img src="${product.image ? product.image : 'images/default-product.png'}" alt="${product.name}">
        <h3>${product.name}</h3>
        <p>K${product.price}</p>
        <div class="product-actions">
          ${role === 'admin' ? '<button class="edit-product" onclick="editProduct('+product.id+')">Edit</button>' : ''}
          <button class="add-cart" onclick="addToCart(${product.id})">Add to Cart</button>
        </div>
      `;
      container.appendChild(div);
    });
  } else {
    container.innerHTML = '<p style="color:white; text-align:center;">No products available.</p>';
  }
})
.catch(err => {
  console.error(err);
  document.getElementById('products-list').innerHTML = '<p style="color:red; text-align:center;">Failed to load products.</p>';
});

// Example functions for admin and user actions
function editProduct(id){
  window.location.href = 'edit_product.html?id=' + id;
}
function addToCart(id){
  alert("Product "+id+" added to cart!"); // implement cart logic
}
</script>

</body>
</html>
